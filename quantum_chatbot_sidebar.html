<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ¤– Quantum Cryptography AI Assistant</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 20px;
            text-align: center;
            color: white;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: white;
            margin: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f8f9fa;
            max-height: calc(100vh - 200px);
        }

        .message {
            margin-bottom: 15px;
            animation: fadeIn 0.3s ease-in;
        }

        .message.user {
            text-align: right;
        }

        .message.assistant {
            text-align: left;
        }

        .message-content {
            display: inline-block;
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            word-wrap: break-word;
            white-space: pre-wrap;
        }

        .message.user .message-content {
            background: #007bff;
            color: white;
        }

        .message.assistant .message-content {
            background: white;
            color: #333;
            border: 1px solid #e9ecef;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .message-label {
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 5px;
            opacity: 0.7;
        }

        .input-container {
            padding: 20px;
            background: white;
            border-top: 1px solid #e9ecef;
        }

        .input-row {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }

        .message-input {
            flex: 1;
            min-height: 60px;
            max-height: 120px;
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            resize: vertical;
            font-family: inherit;
            font-size: 14px;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .message-input:focus {
            border-color: #007bff;
        }

        .send-button {
            padding: 12px 24px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s ease;
            white-space: nowrap;
        }

        .send-button:hover {
            background: #0056b3;
        }

        .send-button:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }

        .quick-actions {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .quick-btn {
            padding: 8px 16px;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 20px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .quick-btn:hover {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .quick-btn.bb84 { background: #17a2b8; color: white; }
        .quick-btn.b92 { background: #28a745; color: white; }
        .quick-btn.debug { background: #dc3545; color: white; }
        .quick-btn.code { background: #ffc107; color: #212529; }

        .status {
            text-align: center;
            padding: 10px;
            font-size: 12px;
            color: #6c757d;
        }

        .thinking {
            display: none;
            text-align: center;
            padding: 10px;
            color: #6c757d;
            font-style: italic;
        }

        .thinking.show {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            overflow-x: auto;
        }

        .copy-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            margin-left: 8px;
        }

        .copy-btn:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ðŸ¤– Quantum Cryptography AI Assistant</h1>
        <p>Powered by Gemini 1.5 Flash â€¢ Complete code implementations with skeleton function support</p>
    </div>

    <div class="chat-container">
        <div class="quick-actions">
            <button class="quick-btn bb84" onclick="sendQuickMessage('Explain BB84 protocol and provide Python implementation')">BB84</button>
            <button class="quick-btn b92" onclick="sendQuickMessage('Explain B92 protocol and provide Python implementation')">B92</button>
            <button class="quick-btn debug" onclick="sendQuickMessage('Help me debug my quantum simulation code')">Debug</button>
            <button class="quick-btn code" onclick="sendQuickMessage('Show me Python code for quantum key distribution with examples')">Code</button>
        </div>

        <div class="chat-messages" id="chatMessages">
            <div class="message assistant">
                <div class="message-label">ðŸ¤– Assistant</div>
                <div class="message-content">
                    Welcome! I'm your Quantum Networking AI Assistant.

âœ¨ I provide complete, executable code for quantum cryptography protocols.
ðŸŽ¯ I can work with skeleton functions - just provide the method signatures!
ðŸ“š Ask me about BB84, B92, quantum mechanics, or debugging help.
ðŸ’¡ Example: 'Implement BB84 protocol' or paste your skeleton functions for completion.

Ready to help with your quantum cryptography learning!
                </div>
            </div>
        </div>

        <div class="thinking" id="thinking">ðŸ¤” Thinking...</div>

        <div class="input-container">
            <div class="input-row">
                <textarea 
                    class="message-input" 
                    id="messageInput" 
                    placeholder="Ask me about quantum cryptography, BB84, B92, or provide skeleton functions..."
                    rows="2"
                ></textarea>
                <button class="send-button" id="sendButton" onclick="sendMessage()">Send</button>
            </div>
            <div class="status">
                Press Enter to send â€¢ Shift+Enter for new line
            </div>
        </div>
    </div>

    <script>
        const API_KEY = 'AIzaSyA3AYjoulpdQ_bFyRB4bx7Eduo7paxz34c';
        const API_URL = 'https://generativelanguage.googleapis.com/v1beta/openai/chat/completions';
        
        let messages = [
            {
                role: "system",
                content: `You are an expert Quantum Networking AI Assistant specializing in quantum cryptography education. Your role is to help students learn and implement quantum key distribution protocols, particularly BB84 and B92.

## EXPERTISE AREAS:
- **BB84 Protocol**: Complete implementation including qubit preparation, basis selection, measurement, sifting, error detection, and privacy amplification
- **B92 Protocol**: Simplified 2-state protocol with |0âŸ© and |+âŸ© states, measurement in X basis, sifting process, and error estimation
- **Quantum Mechanics**: Superposition, entanglement, measurement, quantum states, bases (Z and X), qubits
- **Python Implementation**: Using pure Python with standard libraries (random, numpy, math) for quantum simulations
- **Quantum Security**: Error rates, eavesdropping detection, key reconciliation, privacy amplification
- **Debugging**: Identifying and fixing common quantum simulation errors

## CRITICAL REQUIREMENTS FOR ALL CODE RESPONSES:

### 1. COMPLETENESS MANDATE:
- **ALWAYS** provide 100% complete, executable code - NO placeholders, NO "TODO" comments, NO incomplete sections
- Every method must be fully implemented with all logic, error handling, and edge cases
- Include ALL necessary imports at the top
- **MANDATORY**: Always provide complete class definitions with all required attributes and methods
- Code must be immediately copy-paste executable without any modifications

### 2. PROFESSIONAL CODE STRUCTURE:
- **Comprehensive Documentation**: Every function needs detailed docstrings explaining purpose, parameters, returns, and quantum mechanics concepts
- **Descriptive Variable Names**: Use self-explanatory names (e.g., \`random_bits\`, \`measurement_bases\`, \`quantum_states\` instead of generic names)
- **Detailed Comments**: Explain every quantum operation, basis choice, and algorithmic step
- **User-Friendly Output**: Include informative print statements with emojis, formatted summaries, and progress indicators
- **Error Handling**: Add try-catch blocks and input validation where appropriate

### 3. IMPLEMENTATION EXCELLENCE:
- **Complete Method Bodies**: Never leave methods empty or with generic implementations
- **Pure Python Focus**: Use only standard Python libraries (random, numpy, math) - NO qutip, NO external quantum libraries
- **String Representations**: Use string representations for quantum states (e.g., "|0âŸ©", "|1âŸ©", "|+âŸ©", "|-âŸ©")
- **Realistic Examples**: Use practical parameters and demonstrate actual protocol execution
- **Visual Feedback**: Include progress messages, summaries, and formatted output for educational value
- **Scalable Design**: Handle varying input sizes gracefully (e.g., preview logic for large datasets)

### 4. QUANTUM PROTOCOL SPECIFICATIONS:

#### BB84 Protocol Requirements:
- Alice generates random bits (0/1) AND random bases (Z=0/X=1)
- Qubit preparation: Z-basis â†’ |0âŸ©, |1âŸ©; X-basis â†’ |+âŸ©, |-âŸ©
- Bob performs random basis measurements
- Sifting process: retain only matching basis measurements
- Error detection: compare random subset of sifted bits
- Privacy amplification: adjust final key length based on error rate

#### B92 Protocol Requirements:
- Alice sends only |0âŸ© (representing bit 0) or |+âŸ© (representing bit 1)
- Bob measures all qubits exclusively in X-basis
- Sifting: Bob retains only inconclusive measurements (|+âŸ© or |-âŸ© results)
- Error estimation: compare Alice's original bits with Bob's retained measurements
- Key generation: derive final key from successfully sifted bits

### 5. EDUCATIONAL ENHANCEMENTS:
- **Theory-to-Practice Connection**: Explain quantum mechanics principles behind each implementation step
- **Mathematical Context**: Include relevant formulas and state representations
- **Security Analysis**: Discuss vulnerability points and defensive measures
- **Real-World Applications**: Connect to practical quantum cryptography systems
- **Progressive Complexity**: Start with core concepts, build to advanced features

### 6. CODE QUALITY CHECKLIST (Apply to EVERY response):
âœ… All imports included and correct
âœ… Complete function implementations (no placeholders)
âœ… **Complete class definitions with all methods**
âœ… Comprehensive docstrings and comments
âœ… Descriptive variable naming throughout
âœ… User-friendly output with formatting
âœ… Error handling and edge case management
âœ… Realistic examples and demonstrations
âœ… Educational explanations embedded in code
âœ… Immediately executable without modifications
âœ… Professional presentation and structure
âœ… **Pure Python implementation (no external quantum libraries)**

### 7. RESPONSE STRUCTURE TEMPLATE:
1. **Brief conceptual overview** (2-3 sentences)
2. **Complete, executable code** in properly formatted blocks
3. **Detailed explanation** of quantum mechanics principles
4. **Implementation walkthrough** explaining each major section
5. **Usage example** with expected output
6. **Extensions/improvements** suggestions if applicable

### 8. DEBUGGING AND OPTIMIZATION:
- Identify and fix common quantum simulation errors
- Suggest performance optimizations
- Provide alternative implementation approaches
- Explain trade-offs between different design choices

## INTERACTION GUIDELINES:
- Ask clarifying questions only if the request is genuinely ambiguous
- Default to providing the most complete, educational implementation possible
- Always explain the quantum physics behind the code
- Connect implementations to real quantum cryptography systems
- Provide multiple examples when beneficial for learning

## QUALITY ASSURANCE:
Before providing any code response, verify:
1. âœ… Code is 100% complete and executable
2. âœ… All quantum operations are correctly implemented
3. âœ… Educational value is maximized through documentation
4. âœ… Professional standards are met throughout
5. âœ… Protocol specifications are accurately followed
6. âœ… **Complete class definitions are provided**
7. âœ… **Pure Python implementation (no external libraries)**

Remember: Students learn best from complete, working examples that they can immediately run and modify. Never provide incomplete code or placeholders. Always deliver production-quality implementations that serve as educational exemplars. **CRITICAL**: Always provide complete class definitions and use pure Python with standard libraries only.`
            }
        ];

        function addMessage(role, content) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;
            
            const labelDiv = document.createElement('div');
            labelDiv.className = 'message-label';
            labelDiv.textContent = role === 'user' ? 'ðŸ‘¤ You' : 'ðŸ¤– Assistant';
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            
            // Format code blocks
            content = content.replace(/```python\n([\s\S]*?)\n```/g, '<div class="code-block">$1<button class="copy-btn" onclick="copyToClipboard(this)">Copy</button></div>');
            content = content.replace(/```\n([\s\S]*?)\n```/g, '<div class="code-block">$1<button class="copy-btn" onclick="copyToClipboard(this)">Copy</button></div>');
            
            contentDiv.innerHTML = content;
            
            messageDiv.appendChild(labelDiv);
            messageDiv.appendChild(contentDiv);
            chatMessages.appendChild(messageDiv);
            
            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function showThinking() {
            document.getElementById('thinking').classList.add('show');
        }

        function hideThinking() {
            document.getElementById('thinking').classList.remove('show');
        }

        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message
            addMessage('user', message);
            input.value = '';
            
            // Show thinking
            showThinking();
            
            // Add to messages array
            messages.push({ role: 'user', content: message });
            
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'gemini-1.5-flash-latest',
                        messages: messages,
                        max_tokens: 4000,
                        temperature: 0.7
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(`API Error ${response.status}: ${errorData.error?.message || response.statusText}`);
                }
                
                const data = await response.json();
                
                if (!data.choices || !data.choices[0] || !data.choices[0].message) {
                    throw new Error('Invalid API response format');
                }
                
                const aiResponse = data.choices[0].message.content;
                
                // Add AI response
                addMessage('assistant', aiResponse);
                messages.push({ role: 'assistant', content: aiResponse });
                
            } catch (error) {
                console.error('API Error:', error);
                let errorMessage = `âŒ Error: ${error.message}`;
                
                if (error.message.includes('40')) {
                    errorMessage += '\n\nðŸ’¡ This might be due to:\nâ€¢ API rate limiting\nâ€¢ Invalid API key\nâ€¢ Network connectivity issues\n\nTry again in a few moments.';
                } else if (error.message.includes('401')) {
                    errorMessage += '\n\nðŸ’¡ API key issue. Please check your Gemini API key.';
                } else if (error.message.includes('429')) {
                    errorMessage += '\n\nðŸ’¡ Rate limit exceeded. Please wait a moment before trying again.';
                }
                
                addMessage('assistant', errorMessage);
            } finally {
                hideThinking();
            }
        }

        function sendQuickMessage(message) {
            document.getElementById('messageInput').value = message;
            sendMessage();
        }

        function copyToClipboard(button) {
            const codeBlock = button.previousSibling;
            const text = codeBlock.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                button.textContent = 'Copied!';
                setTimeout(() => {
                    button.textContent = 'Copy';
                }, 2000);
            });
        }

        // Event listeners
        document.getElementById('messageInput').addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        document.getElementById('sendButton').addEventListener('click', sendMessage);
    </script>
</body>
</html>
